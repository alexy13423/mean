<<<<<<< HEAD
var app=angular.module("mainApp",["templates"]);app.controller("MainCtrl",["$scope","auth","$location",function(o,n){o.user={},o.register=function(){n.register(o.user).error(function(n){o.error=n}).then(function(){window.location="http://localhost:3000/user/#/home"})},o.logIn=function(){n.logIn(o.login).error(function(n){o.error=n}).then(function(){window.location="http://localhost:3000/user/#/home"})},o.forgotPassword=function(){n.forgotPassword(o.forgot).error(function(n){console.log(o.forgot),o.error=n})},o.isLoggedIn=n.isLoggedIn,o.currentUser=n.currentUser,o.logOut=n.logOut}]),app.factory("auth",["$http","$window",function(o,n){var t={};return t.saveToken=function(o){n.localStorage["admin-token"]=o},t.getToken=function(){return n.localStorage["admin-token"]},t.isLoggedIn=function(){var o=t.getToken();if(o){var r=JSON.parse(n.atob(o.split(".")[1]));return r.exp>Date.now()/1e3}return!1},t.isGroupMember=function(){var o=t.getToken();if(o){var r=JSON.parse(n.atob(o.split(".")[1]));return r.group_id=this.group_id}return!1},t.currentUser=function(){if(t.isLoggedIn()){var o=t.getToken(),r=JSON.parse(n.atob(o.split(".")[1]));return r.username}},t.register=function(n){return o.post("/api/register",n).success(function(o){t.saveToken(o.token)})},t.logIn=function(n){return o.post("/api/login",n).success(function(o){t.saveToken(o.token)})},t.logOut=function(){n.localStorage.removeItem("admin-token")},t.forgotPassword=function(n){return o.post("/api/forgot",n).success(function(o){t.saveToken(o.token),$scope.success=!0})},t}]);
=======
var app=angular.module("mainApp",["templates"]);app.controller("MainCtrl",["$scope","auth","$location",function(o,e){o.user={},o.register=function(){e.register(o.user).error(function(e){o.error=e}).then(function(){window.location="http://localhost:3000/user/#/home"}),mixpanel.track("HomePage: Register")},o.logIn=function(){e.logIn(o.login).error(function(e){o.error=e}).then(function(){window.location="http://localhost:3000/user/#/home"}),mixpanel.track("HomePage: Login")},o.forgotPassword=function(){e.forgotPassword(o.forgot).error(function(e){console.log(o.forgot),o.error=e}),mixpanel.track("HomePage: Reset Password, Submit Email")},o.isLoggedIn=e.isLoggedIn,o.currentUser=e.currentUser,o.logOut=e.logOut}]),app.factory("auth",["$http","$window",function(o,e){var n={};return n.saveToken=function(o){e.localStorage["admin-token"]=o},n.getToken=function(){return e.localStorage["admin-token"]},n.isLoggedIn=function(){var o=n.getToken();if(o){var t=JSON.parse(e.atob(o.split(".")[1]));return t.exp>Date.now()/1e3}return!1},n.currentUser=function(){if(n.isLoggedIn()){var o=n.getToken(),t=JSON.parse(e.atob(o.split(".")[1]));return t.username}},n.register=function(e){return o.post("/api/register",e).success(function(o){n.saveToken(o.token)})},n.logIn=function(e){return o.post("/api/login",e).success(function(o){n.saveToken(o.token)})},n.logOut=function(){e.localStorage.removeItem("admin-token")},n.forgotPassword=function(e){return o.post("/api/forgot",e).success(function(o){n.saveToken(o.token),$scope.success=!0})},n}]);
>>>>>>> 3984fd4724b31bd08a524febc80900015ef72290
