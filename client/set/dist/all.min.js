var app=angular.module("mainApp",["ui.router","templates"]);app.config(["$stateProvider","$urlRouterProvider",function(e,r){e.state("emailVerify",{url:"/emailverify/:username/:user_token",templateUrl:"emailVerify.html",resolve:{verification:["$stateParams","verification",function(e,r){return r.emailVerify(e.username,e.user_token)}]},controller:"MainCtrl"}).state("resetPassword",{url:"/resetpassword/:username/:token",templateUrl:"resetPassword.html",controller:"ResetCtrl"}).state("search",{url:"/search",templateUrl:"search.html",controller:"SearchCtrl"}).state("userProfile",{url:"/user/:handle",templateUrl:"userProfile.html",controller:"UserCtrl",resolve:{usersPromise:["$stateParams","users",function(e,r){return r.get(e.id)}]}})}]),app.controller("MainCtrl",["$scope",function(e){console.log("Redirecting to user app"),window.location="http://localhost:3000/user/#/home"}]),app.controller("ResetCtrl",["$scope","$state","verification",function(e,r,s){e.submitPassword=function(t){console.log(r.params.username),console.log(r.params.token),console.log(e.user.password),console.log(e.user.repeat_password),s.updatePassword(t,r.params.username,r.params.token,e.user.password).success(function(){}).error(function(r){e.error=r,e.showSuccessAlert=!0})}}]),app.controller("SearchCtrl",["$scope",function(e){e.submitSearch=function(){console.log(e.search),search.query(e.search)}}]),app.controller("UserCtrl",["$scope","users","auth","usersPromise",function(e,r,s,t){e.user=t.data,console.log(t)}]),app.factory("verification",["$http","$window",function(e,r){return{getUser:function(r,s,t){return e.get("/resetpassword/"+s+"/"+t).success(function(e){return e})},emailVerify:function(r,s){return e.put("/api/emailverify/"+r+"/"+s).success(function(e){console.log(e.message)})},updatePassword:function(r,s,t,o){return e.put("/api/resetpassword/"+s+"/"+t).success(function(e){console.log("Success!")})}}}]),app.factory("search",["$http",function(e){return{search:function(r){return e.post("/search/",{query:r}).success(function(e){return e})}}}]),app.factory("users",["$http","$window",function(e,r){var s={users:[]};return s.get=function(r){return e.get("/api/user/"+r).success(function(e){return console.log(e),e})},s}]);